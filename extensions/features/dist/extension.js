(()=>{"use strict";var e={7520:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeDocumentRange=t.consumeDocument=void 0;const r=n(7549),o=n(5292),s=n(9603);t.consumeDocument=e=>{const t=e.getText(new r.Range(e.lineAt(0).range.start,e.lineAt(e.lineCount-1).range.end)),n=new o.Context(e.uri.path);return s.Lexer.consumeText(t,n),s.Parser.consumeTokens(n.tokens,n),n},t.tokenizeDocumentRange=(e,t,n)=>{const a=new o.Context(e.uri.path),i=e.getText(new r.Range(t,n));return s.Lexer.consumeText(i,a),a}},9454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Provider=void 0;const r=n(7549),o=(n(9603),n(4336)),s=n(7520);t.Provider=class{#isIdentity(e,t){return 101===e[t]?.value&&142===e[t-1]?.value}#isIdentifier(e,t){const n=e[t]?.value;return 143===n&&this.#isIdentity(e,t)||127===n||128===n}#basicItems(e,t){switch(e[t--].value){case 143:return this.#isIdentity(e,t)?[o.identifierItem]:[];case 100:return this.#isIdentifier(e,t)?[o.asItem]:o.binaryOperatorList;case 126:return o.operandList;case 129:return[o.tokenItem,o.nodeItem];case 127:case 128:return[o.identityItem,o.identifierItem];case 104:return[o.wordItem];case 105:case 102:case 103:case 141:return o.binaryOperatorList;case 138:return[o.identityItem,o.identifierItem,o.wordItem];case 106:case 142:return[]}}#getSymbolFilters(e,t){for(;t>=0;)switch(e[t--].value){case 126:return[303];case 127:return[300,303];case 128:return[300,301,302]}return[]}#getSymbolTablePath(e,t){const n=[];do{const r=e[t--];100===r?.value&&n.unshift(r.fragment.data)}while(135===e[t--]?.value);return n}#getSymbolTableFromPath(e,t){for(const n of t){const t=e.get(n);if(!t||!t.link)return;e=t.link}return e}#getSymbolList(e,t){const n=[];for(const s of e.names){const a=e.get(s);if(t.includes(a.value)){const e=void 0!==a.link,t=o.getItem(s,"Insert the reference.",{kind:r.CompletionItemKind.Reference,text:e?`${s}.`:s,space:!e});n.push(t)}}return n}#complexItems(e,t){const n=s.consumeDocument(e),r=n.tokens;switch(r[t--].value){case 135:const e=this.#getSymbolTablePath(r,t),s=this.#getSymbolTableFromPath(n.table,e);return s?this.#getSymbolList(s,[304]):[];case 131:case 107:case 108:case 109:case 110:return[...this.#getSymbolList(n.table,this.#getSymbolFilters(r,t)),...o.operandList,...o.unaryOperatorList];case 111:case 112:case 113:case 119:case 120:case 118:case 117:case 121:case 122:case 123:case 124:case 125:case 140:return[...this.#getSymbolList(n.table,this.#getSymbolFilters(r,t)),...o.operandList,...o.unaryOperatorList];case 114:case 115:case 116:return[...this.#getSymbolList(n.table,this.#getSymbolFilters(r,t)),...o.operandList,...o.directionList,...o.unaryOperatorList]}}provideCompletionItems(e,t){const n=s.tokenizeDocumentRange(e,e.lineAt(0).range.start,t),r=n.tokens;if(r.length>0){const t=n.tokens.length-1,o=this.#basicItems(r,t)||this.#complexItems(e,t);if(void 0!==o)return o}return[o.skipItem,o.aliasItem,o.tokenItem,o.nodeItem]}}},4336:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.operandList=t.directionList=t.unaryOperatorList=t.binaryOperatorList=t.rangeItem=t.anyItem=t.wordItem=t.mapItem=t.accessItem=t.setItem=t.hasItem=t.errorItem=t.scopeItem=t.symbolItem=t.pivotItem=t.nextItem=t.rightItem=t.leftItem=t.prependItem=t.appendItem=t.placeItem=t.repeatItem=t.optItem=t.notItem=t.andItem=t.orItem=t.thenElseItem=t.thenItem=t.asItem=t.identifierItem=t.identityItem=t.nodeItem=t.tokenItem=t.aliasItem=t.skipItem=t.getItem=void 0;const r=n(7549),o={command:"editor.action.triggerSuggest",title:"Re-trigger completions..."};t.getItem=(e,t,n)=>{const s=n?.text??e,a=new r.CompletionItem(e,n.kind);return a.insertText=new r.SnippetString(n.space?`${s} `:s),a.commitCharacters=n?.commit,a.documentation=t,a.command=o,a},t.skipItem=t.getItem("skip","Create a skip directive.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.aliasItem=t.getItem("alias","Create an alias directive for a token or node.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.tokenItem=t.getItem("token","Create a token directive.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.nodeItem=t.getItem("node","Create a node directive.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.identityItem=t.getItem("IDENTITY","Set an identity for the current directive.",{kind:r.CompletionItemKind.Text,text:"<${1}>",commit:[">"]}),t.identifierItem=t.getItem("IDENTIFIER","Set an identifier for the current directive.",{kind:r.CompletionItemKind.Text,text:"${1}",commit:[" ","\n"]}),t.asItem=t.getItem("as","Set an expression for the current directive.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.thenItem=t.getItem("then","Set a partial condition based on the last consumption state.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.thenElseItem=t.getItem("then else","Set a full condition based on the last consumption state.",{kind:r.CompletionItemKind.Keyword,text:"then ${1} else ${2}",commit:[" ","\n"]}),t.orItem=t.getItem("or","Set another consumption option.",{kind:r.CompletionItemKind.Keyword,text:"|"}),t.andItem=t.getItem("and","Set another expected consumption.",{kind:r.CompletionItemKind.Keyword,text:"&"}),t.notItem=t.getItem("not","Invert the next consumption state (true to false and vice versa).",{kind:r.CompletionItemKind.Keyword,space:!0}),t.optItem=t.getItem("opt","Set the next consumption as optional.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.repeatItem=t.getItem("repeat","Repeat the next consumption in case of success after the first try.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.placeItem=t.getItem("place","Place the resulting node from the next consumption in another direction.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.appendItem=t.getItem("append","Create and append a new node if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.prependItem=t.getItem("prepend","Create and prepend a new node if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.leftItem=t.getItem("left","Modify the current node direction to left.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.rightItem=t.getItem("right","Modify the current node direction to right.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.nextItem=t.getItem("next","Modify the current node direction to next.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.pivotItem=t.getItem("pivot","Create a new node and pivot the current one if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.symbolItem=t.getItem("symbol","Create a new symbol if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.scopeItem=t.getItem("scope","Create a new symbol scope for the next consumption.",{kind:r.CompletionItemKind.Keyword,space:!0}),t.errorItem=t.getItem("error","Create a new error if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,text:"error <${1}>",commit:[">"],space:!0}),t.hasItem=t.getItem("has","Perform the next consumption if the expected state matches.",{kind:r.CompletionItemKind.Keyword,text:"has <${1}>",commit:[">"],space:!0}),t.setItem=t.getItem("set","Set the state if the next consumption is successful.",{kind:r.CompletionItemKind.Keyword,text:"set <${1}>",commit:[">"],space:!0}),t.accessItem=t.getItem("access","Access a map member.",{kind:r.CompletionItemKind.Operator,text:"."}),t.mapItem=t.getItem("map","Perform the next consumption in a prefix tree.",{kind:r.CompletionItemKind.Keyword,text:"map {${1}}",commit:[",","}"]}),t.wordItem=t.getItem("WORD","Accept a sequence of units.",{kind:r.CompletionItemKind.Keyword,text:"'${1}'",commit:["'"]}),t.anyItem=t.getItem("any","Accept any unit.",{kind:r.CompletionItemKind.Keyword,text:"*"}),t.rangeItem=t.getItem("from to","Accept an unit range.",{kind:r.CompletionItemKind.Keyword,text:"from '${1}' to '${2}'",commit:["'"]}),t.binaryOperatorList=[t.thenItem,t.thenElseItem,t.orItem,t.andItem,t.accessItem],t.unaryOperatorList=[t.notItem,t.optItem,t.repeatItem,t.placeItem,t.appendItem,t.prependItem,t.pivotItem,t.symbolItem,t.scopeItem,t.errorItem,t.hasItem,t.setItem,t.mapItem],t.directionList=[t.leftItem,t.rightItem,t.nextItem],t.operandList=[t.wordItem,t.anyItem,t.rangeItem]},8302:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDiagnostics=void 0;const r=n(7549),o=(n(9603),{4096:"Duplicate identifier.",4097:"Unexpected token.",4098:"Unexpected syntax.",4099:"Unexpected node.",4100:"Unsupported node.",4101:"Unsupported identity.",4102:"Undefined identifiers cannot be referenced.",4103:"Unresolved identifiers cannot be referenced.",4104:"Token reference is not resolved yet.",4105:"Node reference is not resolved yet.",4106:"Alias Token reference is not resolved yet.",4107:"Alias Node reference is not resolved yet.",4108:"Token references cannot be in use here.",4109:"Node references cannot be in use here.",4110:"References for an alias token cannot be in use here.",4111:"References for an alias node cannot be in use here.",4112:"Map cannot be referenced here.",4113:"Map entries cannot be referenced here.",4114:"Map entries must start with a string.",4115:"Multiple tokens with the same expression."}),s=e=>{const t=o[e.value];if(!t)throw new Error(`Error value ${e.value} is not supported.`);return t};t.getDiagnostics=e=>{const t=[];for(const n of e){const e=n.fragment.location,o=r.DiagnosticSeverity.Error,a=new r.Range(new r.Position(e.line,e.column),new r.Position(e.line,e.column));t.push(new r.Diagnostic(a,s(n),o))}return t}},2550:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.update=void 0;const r=n(9603),o=n(7520),s=n(8302);t.update=(e,t)=>{if(t.clear(),e&&"xcheme"===e.languageId){const n=o.consumeDocument(e);if(n.errors.length>0){const r=s.getDiagnostics(n.errors);t.set(e.uri,r)}else{const o=new r.Project.Context(new r.TextCoder);if(r.Optimizer.consumeNodes(n.node,o)&&r.Maker.consumeNodes(n.node,o),o.errors.length>0){const n=s.getDiagnostics(o.errors);t.set(e.uri,n)}}}}},2560:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5050),o=n(2178),s=n(8976),a=n(2629),i=n(7198);t.default=class{#errors=[];#tokens=[];#table=new a.default;#node=new i.default(new o.default("",0,0,new s.default(0,0)),0,this.#table);#name;constructor(e){this.#name=e}get errors(){return this.#errors}get tokens(){return this.#tokens}get table(){return this.#table}get node(){return this.#node}get name(){return this.#name}addError(e,t){this.#errors.push(new r.default(e,t))}}},5050:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#fragment;#value;constructor(e,t){this.#fragment=e,this.#value=t}get fragment(){return this.#fragment}get value(){return this.#value}}},2178:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#source;#begin;#end;#location;constructor(e,t,n,r){this.#source=e,this.#begin=t,this.#end=n,this.#location=r}get source(){return this.#source}get data(){return this.#source.substring(this.#begin,this.#end)}get begin(){return this.#begin}get end(){return this.#end}get location(){return this.#location}}},8976:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#line;#column;constructor(e,t){this.#line=e,this.#column=t}get line(){return this.#line}get column(){return this.#column}}},7198:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#children={};#fragment;#value;#table;constructor(e,t,n){this.#fragment=e,this.#table=n,this.#value=t}get fragment(){return this.#fragment}get value(){return this.#value}get table(){return this.#table}get left(){return this.#children[0]}get right(){return this.#children[1]}get next(){return this.#children[2]}swap(e){[this.#children,e.#children]=[e.#children,this.#children],[this.#fragment,e.#fragment]=[e.#fragment,this.#fragment],[this.#table,e.#table]=[e.#table,this.#table],[this.#value,e.#value]=[e.#value,this.#value]}getChild(e){return this.#children[e]}setChild(e,t){this.#children[e]=t}getLowestChild(e){let t,n=this;for(;n=n.getChild(e);)t=n;return t}}},3173:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#fragment;#value;#node;#link;constructor(e,t,n,r){this.#fragment=e,this.#value=t,this.#node=n,this.#link=r}get fragment(){return this.#fragment}get value(){return this.#value}get node(){return this.#node}get link(){return this.#link}}},2629:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2178);class o{#records={};#length=0;#parent;constructor(e){this.#parent=e}get names(){return Object.keys(this.#records)}get length(){return this.#length}get parent(){return this.#parent}has(e){return void 0!==this.get(e)}get(e){return this.#records[e instanceof r.default?e.data:e]}add(e){const t=e.fragment.data;if(this.#records[t])throw"Unable to add records with duplicate fragment data.";this.#records[t]=e,this.#length++}find(e){const t=this.get(e);return void 0===t&&void 0!==this.#parent?this.#parent.find(e):t}*[Symbol.iterator](){for(const e in this.#records)yield this.#records[e]}}t.default=o},1571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#fragment;#value;constructor(e,t){this.#fragment=e,this.#value=t}get fragment(){return this.#fragment}get value(){return this.#value}}},5292:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScopeSymbolPattern=t.EmitSymbolPattern=t.EmitSymbolRoute=t.PlaceNodePattern=t.PivotNodePattern=t.PrependNodePattern=t.AppendNodePattern=t.EmitNodePattern=t.EmitNodeRoute=t.EmitTokenPattern=t.EmitTokenRoute=t.EmitErrorPattern=t.EmitErrorRoute=t.SetStatePattern=t.HasStatePattern=t.SetStateRoute=t.SetValuePattern=t.SetValueRoute=t.MapFlowPattern=t.StaticFlowPattern=t.RepeatFlowPattern=t.OptFlowPattern=t.NotFlowPattern=t.EndFlowPattern=t.ExpectFlowPattern=t.RunFlowPattern=t.ConditionFlowPattern=t.ChooseFlowPattern=t.FlowRoute=t.RangeUnitPattern=t.ExpectUnitPattern=t.ChooseUnitPattern=t.AnyUnitPattern=t.UnitRoute=t.TokenSource=t.TextSource=t.BaseSource=t.Route=t.Pattern=t.Location=t.Fragment=t.Record=t.Table=t.Token=t.Node=t.Error=t.Context=void 0;var r=n(2560);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return r.default}});var o=n(5050);Object.defineProperty(t,"Error",{enumerable:!0,get:function(){return o.default}});var s=n(7198);Object.defineProperty(t,"Node",{enumerable:!0,get:function(){return s.default}});var a=n(1571);Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return a.default}});var i=n(2629);Object.defineProperty(t,"Table",{enumerable:!0,get:function(){return i.default}});var u=n(3173);Object.defineProperty(t,"Record",{enumerable:!0,get:function(){return u.default}});var d=n(2178);Object.defineProperty(t,"Fragment",{enumerable:!0,get:function(){return d.default}});var c=n(8976);Object.defineProperty(t,"Location",{enumerable:!0,get:function(){return c.default}});var l=n(2862);Object.defineProperty(t,"Pattern",{enumerable:!0,get:function(){return l.default}});var m=n(8792);Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return m.default}});var f=n(2667);Object.defineProperty(t,"BaseSource",{enumerable:!0,get:function(){return f.default}});var p=n(7401);Object.defineProperty(t,"TextSource",{enumerable:!0,get:function(){return p.default}});var h=n(2760);Object.defineProperty(t,"TokenSource",{enumerable:!0,get:function(){return h.default}});var g=n(2405);Object.defineProperty(t,"UnitRoute",{enumerable:!0,get:function(){return g.default}});var P=n(686);Object.defineProperty(t,"AnyUnitPattern",{enumerable:!0,get:function(){return P.default}});var v=n(2615);Object.defineProperty(t,"ChooseUnitPattern",{enumerable:!0,get:function(){return v.default}});var w=n(6661);Object.defineProperty(t,"ExpectUnitPattern",{enumerable:!0,get:function(){return w.default}});var y=n(6073);Object.defineProperty(t,"RangeUnitPattern",{enumerable:!0,get:function(){return y.default}});var b=n(9420);Object.defineProperty(t,"FlowRoute",{enumerable:!0,get:function(){return b.default}});var x=n(129);Object.defineProperty(t,"ChooseFlowPattern",{enumerable:!0,get:function(){return x.default}});var _=n(8299);Object.defineProperty(t,"ConditionFlowPattern",{enumerable:!0,get:function(){return _.default}});var S=n(2792);Object.defineProperty(t,"RunFlowPattern",{enumerable:!0,get:function(){return S.default}});var E=n(5893);Object.defineProperty(t,"ExpectFlowPattern",{enumerable:!0,get:function(){return E.default}});var O=n(6998);Object.defineProperty(t,"EndFlowPattern",{enumerable:!0,get:function(){return O.default}});var I=n(301);Object.defineProperty(t,"NotFlowPattern",{enumerable:!0,get:function(){return I.default}});var R=n(9200);Object.defineProperty(t,"OptFlowPattern",{enumerable:!0,get:function(){return R.default}});var j=n(6838);Object.defineProperty(t,"RepeatFlowPattern",{enumerable:!0,get:function(){return j.default}});var C=n(7705);Object.defineProperty(t,"StaticFlowPattern",{enumerable:!0,get:function(){return C.default}});var M=n(2192);Object.defineProperty(t,"MapFlowPattern",{enumerable:!0,get:function(){return M.default}});var k=n(3672);Object.defineProperty(t,"SetValueRoute",{enumerable:!0,get:function(){return k.default}});var N=n(2850);Object.defineProperty(t,"SetValuePattern",{enumerable:!0,get:function(){return N.default}});var F=n(2837);Object.defineProperty(t,"SetStateRoute",{enumerable:!0,get:function(){return F.default}});var U=n(5160);Object.defineProperty(t,"HasStatePattern",{enumerable:!0,get:function(){return U.default}});var V=n(7593);Object.defineProperty(t,"SetStatePattern",{enumerable:!0,get:function(){return V.default}});var T=n(9393);Object.defineProperty(t,"EmitErrorRoute",{enumerable:!0,get:function(){return T.default}});var K=n(5223);Object.defineProperty(t,"EmitErrorPattern",{enumerable:!0,get:function(){return K.default}});var A=n(5027);Object.defineProperty(t,"EmitTokenRoute",{enumerable:!0,get:function(){return A.default}});var L=n(9351);Object.defineProperty(t,"EmitTokenPattern",{enumerable:!0,get:function(){return L.default}});var $=n(5487);Object.defineProperty(t,"EmitNodeRoute",{enumerable:!0,get:function(){return $.default}});var D=n(5505);Object.defineProperty(t,"EmitNodePattern",{enumerable:!0,get:function(){return D.default}});var q=n(1949);Object.defineProperty(t,"AppendNodePattern",{enumerable:!0,get:function(){return q.default}});var B=n(3533);Object.defineProperty(t,"PrependNodePattern",{enumerable:!0,get:function(){return B.default}});var z=n(7579);Object.defineProperty(t,"PivotNodePattern",{enumerable:!0,get:function(){return z.default}});var H=n(3223);Object.defineProperty(t,"PlaceNodePattern",{enumerable:!0,get:function(){return H.default}});var Z=n(8569);Object.defineProperty(t,"EmitSymbolRoute",{enumerable:!0,get:function(){return Z.default}});var W=n(361);Object.defineProperty(t,"EmitSymbolPattern",{enumerable:!0,get:function(){return W.default}});var Y=n(549);Object.defineProperty(t,"ScopeSymbolPattern",{enumerable:!0,get:function(){return Y.default}})},5223:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(5050),s=n(5893),a=n(2862);class i extends a.default{#target;#value;constructor(e,...t){super(),this.#target=new s.default(...t),this.#value=e}consume(e){e.saveState();const t=this.#target.consume(e);if(t){const{value:t}=e.output,n=this.#value===r.default.Output?t??-1:this.#value,s=new o.default(e.fragment,n);e.emit(s)}return e.discardState(),t}}t.default=i},9393:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(5223);class a extends r.default{constructor(e,t,...n){t instanceof o.default?super(new s.default(e,t),n[0],...n.splice(1)):super(new s.default(e),t,...n)}}t.default=a},129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(4989);class s extends r.default{#targets;constructor(...e){super(),this.#targets=e.map((e=>new o.default(e)))}consume(e){for(const t of this.#targets)if(t.consume(e))return!0;return!1}}t.default=s},8299:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(4989);class s extends r.default{#test;#success;#failure;constructor(e,t,n){super(),this.#test=new o.default(e),this.#success=t,this.#failure=n}consume(e){return this.#test.consume(e)?this.#success.consume(e):!!this.#failure&&this.#failure.consume(e)}}t.default=s},6998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{consume(e){return 0===e.length}}t.default=o},5893:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#targets;constructor(...e){super(),this.#targets=e}consume(e){for(const t of this.#targets)if(!t.consume(e))return!1;return!0}}t.default=o},2192:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#root;#compare(e,t){return("string"==typeof e?e.charCodeAt(0):e)-("string"==typeof t?t.charCodeAt(0):t)}#getNode(e){let t,n=this.#root;for(let r=0;r<e.length;){if(!n)return;const o=this.#compare(n.value,e[r]);o<0?n=n.left:o>0?n=n.right:(t=n,n=n.next,r++)}return t}#setNode(e){let t=this.#root,n=t,r=t,o=0;for(let s=0;s<e.length;){if(t){if(o=this.#compare(t.value,e[s]),o<0){n=t,t=t.left;continue}if(o>0){n=t,t=t.right;continue}}else{const r={value:e[s]};n?(o<0?n.left=t=r:o>0?n.right=t=r:n.next=t=r,o=0):this.#root=n=t=r}r=t,n=t,t=t.next,s++}return r}#findNode(e,t){for(e.saveState();e.length>0&&void 0!==t;){const n=this.#compare(t.value,e.value);if(n<0)t=t.left;else if(n>0)t=t.right;else{if(void 0!==t.pattern)return e.discardState(),t;e.nextState(),t=t.next}}e.restoreState(),e.discardState()}#getLongestConsumptionNode(e){let t,n=this.#root;for(;void 0!==(n=this.#findNode(e,n));)t=n,n=n.next,e.nextState();return t}constructor(...e){super();for(const t of e){const e=this.#getNode(t.units)??this.#setNode(t.units);e&&(e.pattern=t.pattern)}}consume(e){const t=this.#getLongestConsumptionNode(e);return void 0!==t&&(!t.pattern||t.pattern.consume(e))}}t.default=o},301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(4989);class s extends r.default{#target;constructor(...e){super(),this.#target=new o.default(...e)}consume(e){return e.length>0&&!this.#target.consume(e)}}t.default=s},9200:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(4989);class s extends r.default{#target;constructor(...e){super(),this.#target=new o.default(...e)}consume(e){return this.#target.consume(e),!0}}t.default=s},6838:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(5893),s=n(4989);class a extends r.default{#target;#triable;constructor(...e){super(),this.#target=new o.default(...e),this.#triable=new s.default(this.#target)}consume(e){if(this.#target.consume(e)){for(;this.#triable.consume(e););return!0}return!1}}t.default=a},9420:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792);class o extends r.default{constructor(e,t,...n){super(e,t,...n)}}t.default=o},2792:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#callback;constructor(e){super(),this.#callback=e}consume(e){return this.#callback().consume(e)}}t.default=o},7705:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#value;constructor(e){super(),this.#value=e}consume(e){return this.#value}}t.default=o},4989:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(5893);class s extends r.default{#target;constructor(...e){super(),this.#target=new o.default(...e)}consume(e){e.saveState();const t=this.#target.consume(e);return t||e.restoreState(),e.discardState(),t}}t.default=s},1949:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(7198),s=n(5893),a=n(2862);class i extends a.default{#head;#target;#value;#output;#current;constructor(e,t,n,r,...o){super(),this.#head=r,this.#target=new s.default(...o),this.#value=e,this.#output=t,this.#current=n}consume(e){e.saveState();const t=e.output;let n=t.node;t.node=void 0;let s=this.#head.consume(e);if(s){const a=e.fragment;if(s=this.#target.consume(e)){const{table:e,value:s}=t,i=this.#value===r.default.Output?s??-1:this.#value,u=new o.default(a,i,e);u.setChild(this.#output,t.node),n?(n.getLowestChild(this.#current)??n).setChild(this.#current,u):n=u}}return t.node=n,e.discardState(),s}}t.default=i},5505:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(7198),s=n(5893),a=n(2862);class i extends a.default{#target;#value;#output;constructor(e,t,...n){super(),this.#target=new s.default(...n),this.#value=e,this.#output=t}consume(e){e.saveState();const t=this.#target.consume(e);if(t){const{table:t,value:n}=e.output,s=this.#value===r.default.Output?n??-1:this.#value,a=new o.default(e.fragment,s,t);a.setChild(this.#output,e.output.node),e.output.node=void 0,e.emit(a)}return e.discardState(),t}}t.default=i},7579:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(7198),s=n(5893),a=n(2862);class i extends a.default{#head;#target;#value;#output;#current;constructor(e,t,n,r,...o){if(super(),n===t)throw"Current and Output destinations can't have the same value.";this.#head=r,this.#target=new s.default(...o),this.#value=e,this.#output=t,this.#current=n}consume(e){e.saveState();let t=this.#head.consume(e);if(t){const n=e.output,{table:s,value:a}=n,i=e.fragment,u=n.node;if(n.node=void 0,t=this.#target.consume(e)){const e=this.#value===r.default.Output?a??-1:this.#value,t=new o.default(i,e,s);t.setChild(this.#output,n.node),t.setChild(this.#current,u),n.node=t}else n.node=u}return e.discardState(),t}}t.default=i},3223:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(5893);class s extends r.default{#target;#current;constructor(e,...t){super(),this.#target=new o.default(...t),this.#current=e}consume(e){const t=e.output;let n=t.node;t.node=void 0;const r=this.#target.consume(e),o=t.node;return r&&o&&(n?(n.getLowestChild(this.#current)??n).setChild(this.#current,o):n=o),t.node=n,r}}t.default=s},3533:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(7198),s=n(5893),a=n(2862);class i extends a.default{#head;#target;#value;#output;#current;constructor(e,t,n,r,...o){super(),this.#head=r,this.#target=new s.default(...o),this.#value=e,this.#output=t,this.#current=n}consume(e){e.saveState();const t=e.output;let n=t.node;t.node=void 0;let s=this.#head.consume(e);if(s){const a=e.fragment;if(s=this.#target.consume(e)){const{table:e,value:s}=t,i=this.#value===r.default.Output?s??-1:this.#value,u=new o.default(a,i,e);u.setChild(this.#output,t.node),n&&(u.getLowestChild(this.#current)??u).setChild(this.#current,n),n=u}}return t.node=n,e.discardState(),s}}t.default=i},5487:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(5505);class a extends r.default{constructor(e,t,n,...r){n instanceof o.default?super(new s.default(e,t,n),r[0],...r.splice(1)):super(new s.default(e,t),n,...r)}}t.default=a},2862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{consume(e){throw"Consume method doesn't implemented."}}},8792:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{#pattern;#units;constructor(e,t,...n){this.#pattern=e,this.#units=[t,...n]}get pattern(){return this.#pattern}get units(){return this.#units}}},5160:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5893),o=n(2862);class s extends o.default{#target;#value;constructor(e,...t){super(),this.#target=new r.default(...t),this.#value=e}consume(e){return e.output.state===this.#value&&this.#target.consume(e)}}t.default=s},2837:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(7593);class a extends r.default{constructor(e,t,...n){t instanceof o.default?super(new s.default(e,t),n[0],...n.splice(1)):super(new s.default(e),t,...n)}}t.default=a},7593:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5893),o=n(2862);class s extends o.default{#target;#value;constructor(e,...t){super(),this.#target=new r.default(...t),this.#value=e}consume(e){return!!this.#target.consume(e)&&(e.output.state=this.#value,!0)}}t.default=s},361:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(3173),s=n(2862),a=n(5893),i=n(5050);class u extends s.default{#test;#target;#value;constructor(e,t,...n){super(),this.#test=t,this.#target=new a.default(...n),this.#value=e}consume(e){e.saveState();let t=this.#test.consume(e);if(t){const{node:n,table:s,value:a}=e.output,u=e.fragment;if(t=this.#target.consume(e))if(s.has(u)){const t=new i.default(u,4096);e.emit(t)}else{const t=this.#value===r.default.Output?a??-1:this.#value,s=new o.default(u,t,n,e.output.link);e.output.link=void 0,e.emit(s)}}return e.discardState(),t}}t.default=u},8569:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(361);class a extends r.default{constructor(e,t,n,...r){n instanceof o.default?super(new s.default(e,t,n),r[0],...r.splice(1)):super(new s.default(e,t),n,...r)}}t.default=a},549:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862),o=n(5893);class s extends r.default{#target;constructor(...e){super(),this.#target=new o.default(...e)}consume(e){e.openTable();const t=this.#target.consume(e);return e.closeTable(),t}}t.default=s},9351:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2667),o=n(1571),s=n(5893),a=n(2862);class i extends a.default{#target;#value;constructor(e,...t){super(),this.#target=new s.default(...t),this.#value=e}consume(e){e.saveState();const t=this.#target.consume(e);if(t){const{value:t}=e.output,n=this.#value===r.default.Output?t??-1:this.#value,s=new o.default(e.fragment,n);e.emit(s)}return e.discardState(),t}}t.default=i},5027:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(9351);class a extends r.default{constructor(e,t,...n){if(t instanceof o.default){const[r,...o]=n;super(new s.default(e,t),r,...o)}else super(new s.default(e),t,...n)}}t.default=a},686:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{consume(e){return e.length>0&&(e.nextState(),!0)}}t.default=o},2615:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#units;constructor(...e){super(),this.#units=new Set(e)}consume(e){return!!(e.length>0&&this.#units.has(e.value))&&(e.nextState(),!0)}}t.default=o},6661:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#units;constructor(...e){super(),this.#units=e}consume(e){for(const t of this.#units){if(0===e.length||e.value!==t)return!1;e.nextState()}return!0}}t.default=o},6073:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2862);class o extends r.default{#begin;#end;constructor(e,t){super(),this.#begin=e,this.#end=t}consume(e){if(e.length>0){const t=e.value;if(t>=this.#begin&&t<=this.#end)return e.nextState(),!0}return!1}}t.default=o},2405:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792);class o extends r.default{constructor(e,...t){super(null,e,...t)}}t.default=o},3672:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(8792),o=n(2862),s=n(2850);class a extends r.default{constructor(e,t,...n){if(t instanceof o.default){const[r,...o]=n;super(new s.default(e,t),r,...o)}else super(new s.default(e),t,...n)}}t.default=a},2850:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5893),o=n(2862);class s extends o.default{#target;#value;constructor(e,...t){super(),this.#target=new r.default(...t),this.#value=e}consume(e){return!!this.#target.consume(e)&&(e.output.value=this.#value,!0)}}t.default=s},2667:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5050),o=n(1571),s=n(7198),a=n(3173),i=n(2629);t.default=class{#context;#table;#output;static get Output(){return 4294967295}constructor(e){this.#context=e,this.#table=e.table,this.#output={state:0,table:this.#table}}get output(){return this.#output}get offset(){throw"Property doesn't implemented."}get length(){throw"Property doesn't implemented."}get value(){throw"Property doesn't implemented."}get fragment(){throw"Property doesn't implemented."}saveState(){throw"Method doesn't implemented."}restoreState(){throw"Method doesn't implemented."}discardState(){throw"Method doesn't implemented."}nextState(){throw"Move method doesn't implemented."}emit(e){if(e instanceof r.default)this.#context.errors.push(e);else if(e instanceof o.default)this.#context.tokens.push(e);else if(e instanceof s.default)(this.#context.node.getLowestChild(2)??this.#context.node).setChild(2,e);else{if(!(e instanceof a.default))throw"Unsupported product type.";this.#table.add(e)}}openTable(){this.#table=new i.default(this.#table),this.#output.table=this.#table}closeTable(){if(!this.#table.parent)throw"There's no parent symbol table to collapse.";this.#table.length>0&&(this.#output.link=this.#table),this.#table=this.#table.parent,this.#output.table=this.#table}}},7401:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2178),o=n(8976),s=n(2667);class a extends s.default{#data;#states=[];#current={line:0,column:0,offset:0};#longest={...this.#current};constructor(e,t){super(t),this.#data=e}get offset(){return this.#current.offset}get length(){return this.#data.length-this.offset}get value(){const e=this.#data[this.offset];if(void 0===e)throw"There's no value to get.";return e}get fragment(){if(this.#states.length>0){const e=this.#states[this.#states.length-1];if(this.offset>e.offset){const t=new o.default(e.line,e.column);return new r.default(this.#data,e.offset,this.offset,t)}}const e=this.offset+(this.length>0?1:0),t=new o.default(this.#current.line,this.#current.column);return new r.default(this.#data,this.offset,e,t)}get currentState(){return this.#current}get longestState(){return this.#longest}saveState(){this.#states.push({...this.#current})}restoreState(){if(void 0===(this.#current=this.#states[this.#states.length-1]))throw"There's no state to restore."}discardState(){this.#states.pop()}nextState(){"\n"!==this.value?this.#current.column++:(this.#current.column=0,this.#current.line++),this.#current.offset++,this.#current.offset>this.#longest.offset&&(this.#longest={...this.#current})}}t.default=a},2760:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2178),o=n(2667);class s extends o.default{#data;#states=[];#current={offset:0};#longest={...this.#current};constructor(e,t){super(t),this.#data=e}get offset(){return this.#current.offset}get length(){return this.#data.length-this.offset}get value(){const e=this.#data[this.offset];if(void 0===e)throw"There's no value to get.";return e.value}get fragment(){if(this.#states.length>0){const e=this.#states[this.#states.length-1];if(this.offset>e.offset){const t=this.#data[e.offset].fragment,n=this.#data[Math.max(0,this.offset-1)].fragment;return new r.default(t.source,t.begin,n.end,t.location)}}const e=Math.min(this.offset,this.#data.length-1);return this.#data[e].fragment}get currentState(){return this.#current}get longestState(){return this.#longest}saveState(){this.#states.push({...this.#current})}restoreState(){if(void 0===(this.#current=this.#states[this.#states.length-1]))throw"There's no state to restore."}discardState(){this.#states.pop()}nextState(){this.#current.offset++,this.#current.offset>this.#longest.offset&&(this.#longest={...this.#current})}}t.default=s},1299:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Base=void 0,t.Base=class{getEntry(e,t,n){throw"Method doesn't implemented."}getRoute(e,t,n){throw"Method doesn't implemented."}emitMapPattern(...e){throw"Method doesn't implemented."}emitTokenPattern(e,...t){throw"Method doesn't implemented."}emitNodePattern(e,t,...n){throw"Method doesn't implemented."}emitIdentityPattern(e,...t){throw"Method doesn't implemented."}emitConditionPattern(e,t,n){throw"Method doesn't implemented."}emitChoosePattern(...e){throw"Method doesn't implemented."}emitChooseUnitsPattern(e){throw"Method doesn't implemented."}emitExpectPattern(...e){throw"Method doesn't implemented."}emitExpectUnitsPattern(e){throw"Method doesn't implemented."}emitNotPattern(...e){throw"Method doesn't implemented."}emitOptPattern(...e){throw"Method doesn't implemented."}emitRepeatPattern(...e){throw"Method doesn't implemented."}emitPlacePattern(e,...t){throw"Method doesn't implemented."}emitAppendPattern(e,t,n,...r){throw"Method doesn't implemented."}emitPrependPattern(e,t,n,...r){throw"Method doesn't implemented."}emitPivotPattern(e,t,...n){throw"Method doesn't implemented."}emitSymbolPattern(e,t,...n){throw"Method doesn't implemented."}emitScopePattern(...e){throw"Method doesn't implemented."}emitErrorPattern(e,...t){throw"Method doesn't implemented."}emitHasPattern(e,...t){throw"Method doesn't implemented."}emitSetPattern(e,...t){throw"Method doesn't implemented."}emitReferencePattern(e,t){throw"Method doesn't implemented."}emitAnyPattern(){throw"Method doesn't implemented."}emitRangePattern(e,t){throw"Method doesn't implemented."}}},6224:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Live=void 0;const r=n(5292),o=n(1299);class s extends o.Base{getEntry(e,t,n){return new r.ExpectFlowPattern(new r.OptFlowPattern(new r.RepeatFlowPattern(new r.ChooseFlowPattern(...n))),new r.EndFlowPattern)}getRoute(e,t,n){const[o,...s]=e;return void 0!==t?void 0!==n?new r.SetValueRoute(t,n,...e):new r.SetValueRoute(t,o,...s):void 0!==n?new r.FlowRoute(n,o,...s):new r.UnitRoute(o,...s)}emitMapPattern(...e){return new r.MapFlowPattern(...e)}emitTokenPattern(e,...t){return new r.EmitTokenPattern(e,...t)}emitNodePattern(e,t,...n){return new r.EmitNodePattern(e,t,...n)}emitIdentityPattern(e,...t){return new r.SetValuePattern(e,...t)}emitConditionPattern(e,t,n){return new r.ConditionFlowPattern(e,t,n)}emitChoosePattern(...e){return new r.ChooseFlowPattern(...e)}emitChooseUnitsPattern(e){return new r.ChooseUnitPattern(...e)}emitExpectPattern(...e){return new r.ExpectFlowPattern(...e)}emitExpectUnitsPattern(e){return new r.ExpectUnitPattern(...e)}emitNotPattern(...e){return new r.NotFlowPattern(...e)}emitOptPattern(...e){return new r.OptFlowPattern(...e)}emitRepeatPattern(...e){return new r.RepeatFlowPattern(...e)}emitPlacePattern(e,...t){return new r.PlaceNodePattern(e,...t)}emitAppendPattern(e,t,n,...o){return new r.AppendNodePattern(e,1,t,n,...o)}emitPrependPattern(e,t,n,...o){return new r.PrependNodePattern(e,1,t,n,...o)}emitPivotPattern(e,t,...n){return new r.PivotNodePattern(e,1,0,t,...n)}emitSymbolPattern(e,t,...n){return new r.EmitSymbolPattern(e,t,...n)}emitScopePattern(...e){return new r.ScopeSymbolPattern(...e)}emitErrorPattern(e,...t){return new r.EmitErrorPattern(e,...t)}emitHasPattern(e,...t){return new r.HasStatePattern(e,...t)}emitSetPattern(e,...t){return new r.SetStatePattern(e,...t)}emitReferencePattern(e,t){const n=e.get(t);return n.pattern?n.pattern:new r.RunFlowPattern((()=>e.get(t).pattern))}emitAnyPattern(){return new r.AnyUnitPattern}emitRangePattern(e,t){return new r.RangeUnitPattern(e,t)}}t.Live=s},2735:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0,n(5292);const r=n(8525),o=n(1299);class s extends o.Base{#getIdentifier(e){return"U_"+e.replace(/[^a-zA-Z0-9]/g,"")}#getUnits(e){return e.map((e=>"number"!=typeof e?r.compose(e):e))}#getPattern(e,...t){return`new Core.${e}(${t.join(", ")})`}#getReference(e){return`const ${this.#getIdentifier(e.name)} = ${e.pattern};`}#getExportEntry(e,t){return`exports.${e} = ${t};`}getEntry(e,t,n){return t.map((e=>this.#getReference(e))).join("")+this.#getExportEntry(e,this.#getPattern("ExpectFlowPattern",this.#getPattern("OptFlowPattern",this.#getPattern("RepeatFlowPattern",this.#getPattern("ChooseFlowPattern",...n))),this.#getPattern("EndFlowPattern")))}getRoute(e,t,n){return void 0!==t?void 0!==n?this.#getPattern("SetValueRoute",t,n,...this.#getUnits(e)):this.#getPattern("SetValueRoute",t,...this.#getUnits(e)):void 0!==n?this.#getPattern("FlowRoute",n,...this.#getUnits(e)):this.#getPattern("UnitRoute",...this.#getUnits(e))}emitMapPattern(...e){return this.#getPattern("MapFlowPattern",...e)}emitTokenPattern(e,...t){return this.#getPattern("EmitTokenPattern",e,...t)}emitNodePattern(e,t,...n){return this.#getPattern("EmitNodePattern",e,t,...n)}emitIdentityPattern(e,...t){return this.#getPattern("SetValuePattern",e,...t)}emitConditionPattern(e,t,n){return this.#getPattern("ConditionFlowPattern",...n?[e,t,n]:[e,t])}emitChoosePattern(...e){return this.#getPattern("ChooseFlowPattern",...e)}emitChooseUnitsPattern(e){return this.#getPattern("ChooseUnitPattern",...this.#getUnits(e))}emitExpectPattern(...e){return this.#getPattern("ExpectFlowPattern",...e)}emitExpectUnitsPattern(e){return this.#getPattern("ExpectUnitPattern",...this.#getUnits(e))}emitNotPattern(...e){return this.#getPattern("NotFlowPattern",...e)}emitOptPattern(...e){return this.#getPattern("OptFlowPattern",...e)}emitRepeatPattern(...e){return this.#getPattern("RepeatFlowPattern",...e)}emitPlacePattern(e,...t){return this.#getPattern("PlaceNodePattern",e,...t)}emitAppendPattern(e,t,n,...r){return this.#getPattern("AppendNodePattern",e,1,t,n,...r)}emitPrependPattern(e,t,n,...r){return this.#getPattern("PrependNodePattern",e,1,t,n,...r)}emitPivotPattern(e,t,...n){return this.#getPattern("PivotNodePattern",e,1,0,t,...n)}emitSymbolPattern(e,t,...n){return this.#getPattern("EmitSymbolPattern",e,t,...n)}emitScopePattern(...e){return this.#getPattern("ScopeSymbolPattern",...e)}emitErrorPattern(e,...t){return this.#getPattern("EmitErrorPattern",e,...t)}emitHasPattern(e,...t){return this.#getPattern("HasStatePattern",e,...t)}emitSetPattern(e,...t){return this.#getPattern("SetStatePattern",e,...t)}emitReferencePattern(e,t){return e.get(t).pattern?this.#getIdentifier(t):this.#getPattern("RunFlowPattern",`() => ${this.#getIdentifier(t)}`)}emitAnyPattern(){return this.#getPattern("AnyUnitPattern")}emitRangePattern(e,t){return this.#getPattern("RangeUnitPattern",...this.#getUnits([e,t]))}}t.Text=s},1095:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregator=void 0,t.Aggregator=class{#entries={};#links={};#events={};get all(){return Object.values(this.#entries)}get patterns(){return this.all.filter((e=>!e.alias&&0===e.references))}get references(){return this.all.filter((e=>e.references>0))}has(e){return void 0!==this.#entries[e]||void 0!==this.#links[e]}get(e){return this.#entries[e]??this.#links[e]}add(e,t,n,r){if(this.has(t))throw`Another entry named '${t}' can't be added.`;const o=this.#events[t],s=this.#entries[t]={origin:e,identifier:t,identity:n,alias:r?.alias??!1,dynamic:r?.dynamic??!1,force:r?.force??!1,references:r?.references??0,pattern:r?.pattern};if(void 0!==o){delete this.#events[t];for(const e of o)e(s)}return s}link(e,t){if(this.has(e))throw`An entry named '${e}' already exists.`;if(!this.has(t))throw`An entry named '${t}' doesn't exists.`;return this.#links[e]=this.get(t)}on(e,t){const n=this.#events[e];void 0!==n?n.push(t):this.#events[e]=[t]}}},5796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const r=n(5292);class o extends r.Node{constructor(e){super(e.fragment,e.value,e.table),this.setChild(0,e.left),this.setChild(1,e.right),this.setChild(2,e.next)}get value(){return super.value}}t.Node=o},9171:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const r=n(800);class o extends r.Node{#type;#entry;constructor(e,t,n){super(e,n.identity),this.#type=t,this.#entry=n}get type(){return this.#type}get dynamic(){return this.#entry.dynamic}get alias(){return this.#entry.alias}get identifier(){return this.#entry.identifier}}t.Node=o},800:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const r=n(5796);class o extends r.Node{#identity;constructor(e,t){super(e),this.#identity=t}get identity(){return this.#identity}}t.Node=o},7999:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const r=n(800);class o extends r.Node{#entry;#route;constructor(e,t,n){super(e,t.identity),this.#entry=t,this.#route=n}get dynamic(){return this.#entry.dynamic}get empty(){return this.#route.fragment===this.fragment}get route(){return this.#route}}t.Node=o},5072:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0,n(5292);const r=n(5796);class o extends r.Node{#type;#sequence;#getNodes(e){return this.value===e.value?[...this.#getNodes(e.left),...this.#getNodes(e.right)]:[e]}constructor(e,t){super(e),this.#type=t,this.#sequence=this.#getNodes(e),this.setChild(0,void 0),this.setChild(1,void 0),this.setChild(2,void 0)}get type(){return this.#type}get sequence(){return this.#sequence}}t.Node=o},4226:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const r=n(5292),o=n(1095);t.Context=class{#coder;#options;#errors=[];#skipEntries=new o.Aggregator;#tokenEntries=new o.Aggregator;#nodeEntries=new o.Aggregator;#getPatterns(e){return e.filter((e=>void 0!==e.pattern)).map((e=>e.pattern))}#getReferences(e){return e.filter((e=>void 0!==e.pattern&&(e.force||e.references>1))).map((e=>({name:e.identifier,pattern:e.pattern})))}constructor(e,t={}){this.#coder=e,this.#options=t}get coder(){return this.#coder}get options(){return this.#options}get errors(){return this.#errors}get skipEntries(){return this.#skipEntries}get tokenEntries(){return this.#tokenEntries}get nodeEntries(){return this.#nodeEntries}get lexer(){return this.#coder.getEntry("Lexer",this.#getReferences(this.#tokenEntries.references),[...this.#getPatterns(this.#skipEntries.patterns),...this.#getPatterns(this.#tokenEntries.patterns)])}get parser(){return this.#coder.getEntry("Parser",this.#getReferences(this.#nodeEntries.references),this.#getPatterns(this.#nodeEntries.patterns))}addError(e,t){this.#errors.push(new r.Error(e.fragment,t))}}},8525:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.extract=void 0;const n=["\\\\","\\t","\\v","\\f","\\r","\\n","\\'"],r=new RegExp(`(?:${n.join("|")})`,"g"),o=new RegExp(`(?:${n.join("|").replace(/\\/g,"\\\\")})`,"g");t.extract=e=>(e=>e.replace(o,(e=>{switch(e){case"\\\\":return"\\";case"\\t":return"\t";case"\\v":return"\v";case"\\f":return"\f";case"\\r":return"\r";case"\\n":return"\n";case"\\'":return"'"}return e})))(e.substring(1,e.length-1)),t.compose=e=>{return`'${t=e,t.replace(r,(e=>{switch(e){case"\\":return"\\\\";case"\t":return"\\t";case"\v":return"\\v";case"\f":return"\\f";case"\r":return"\\r";case"\n":return"\\n";case"'":return"\\'"}return e}))}'`;var t}},9603:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Maker=t.Optimizer=t.Parser=t.Lexer=t.Project=t.TextCoder=t.LiveCoder=t.BaseCoder=void 0;var r=n(1299);Object.defineProperty(t,"BaseCoder",{enumerable:!0,get:function(){return r.Base}});var o=n(6224);Object.defineProperty(t,"LiveCoder",{enumerable:!0,get:function(){return o.Live}});var s=n(2735);Object.defineProperty(t,"TextCoder",{enumerable:!0,get:function(){return s.Text}}),t.Project=n(4226),t.Lexer=n(4465),t.Parser=n(1323),t.Optimizer=n(7013),t.Maker=n(9134)},4465:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=t.consumeText=void 0;const r=n(5292),o=n(8807);t.consumeText=(e,t)=>{const n=new r.TextSource(e,t);return!!o.Program.consume(n)||(t.addError(n.fragment,4097),!1)},t.consume=e=>o.Program.consume(e)},8807:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const r=n(5292),o=new r.ChooseUnitPattern(" ","\t","\v","\f","\r","\n"),s=new r.ExpectFlowPattern(new r.ExpectUnitPattern("/","/"),new r.OptFlowPattern(new r.RepeatFlowPattern(new r.ConditionFlowPattern(new r.NotFlowPattern(new r.ExpectUnitPattern("\n")),new r.AnyUnitPattern)))),a=new r.ExpectFlowPattern(new r.ExpectUnitPattern("/","*"),new r.OptFlowPattern(new r.RepeatFlowPattern(new r.ConditionFlowPattern(new r.NotFlowPattern(new r.ExpectUnitPattern("*","/")),new r.AnyUnitPattern))),new r.ExpectUnitPattern("*","/")),i=new r.ChooseFlowPattern(new r.RangeUnitPattern("a","z"),new r.RangeUnitPattern("A","Z")),u=new r.RangeUnitPattern("0","9"),d=new r.ExpectUnitPattern("_"),c=new r.ChooseFlowPattern(i,u,d),l=new r.NotFlowPattern(c),m=new r.MapFlowPattern(new r.SetValueRoute(103,l,"a","n","y"),new r.SetValueRoute(104,l,"f","r","o","m"),new r.SetValueRoute(105,l,"t","o"),new r.SetValueRoute(106,l,"m","a","p"),new r.SetValueRoute(107,l,"t","h","e","n"),new r.SetValueRoute(108,l,"e","l","s","e"),new r.SetValueRoute(109,l,"o","r"),new r.SetValueRoute(110,l,"a","n","d"),new r.SetValueRoute(111,l,"n","o","t"),new r.SetValueRoute(112,l,"o","p","t"),new r.SetValueRoute(113,l,"r","e","p","e","a","t"),new r.SetValueRoute(114,l,"p","l","a","c","e"),new r.SetValueRoute(115,l,"a","p","p","e","n","d"),new r.SetValueRoute(116,l,"p","r","e","p","e","n","d"),new r.SetValueRoute(117,l,"p","i","v","o","t"),new r.SetValueRoute(118,l,"n","e","x","t"),new r.SetValueRoute(119,l,"l","e","f","t"),new r.SetValueRoute(120,l,"r","i","g","h","t"),new r.SetValueRoute(121,l,"s","y","m","b","o","l"),new r.SetValueRoute(122,l,"s","c","o","p","e"),new r.SetValueRoute(123,l,"e","r","r","o","r"),new r.SetValueRoute(124,l,"h","a","s"),new r.SetValueRoute(125,l,"s","e","t"),new r.SetValueRoute(126,l,"s","k","i","p"),new r.SetValueRoute(127,l,"t","o","k","e","n"),new r.SetValueRoute(128,l,"n","o","d","e"),new r.SetValueRoute(129,l,"a","l","i","a","s"),new r.SetValueRoute(130,l,"a","u","t","o"),new r.SetValueRoute(131,l,"a","s"),new r.SetValueRoute(132,"*"),new r.SetValueRoute(133,"|"),new r.SetValueRoute(134,"&"),new r.SetValueRoute(135,"."),new r.SetValueRoute(136,","),new r.SetValueRoute(137,";"),new r.SetValueRoute(138,"{"),new r.SetValueRoute(139,"}"),new r.SetValueRoute(140,"("),new r.SetValueRoute(141,")"),new r.SetValueRoute(142,"<"),new r.SetValueRoute(143,">")),f=new r.SetValuePattern(101,new r.ChooseFlowPattern(new r.ExpectUnitPattern("0"),new r.ExpectFlowPattern(new r.RangeUnitPattern("1","9"),new r.OptFlowPattern(new r.RepeatFlowPattern(u))))),p=new r.SetValuePattern(102,new r.ExpectUnitPattern("'"),new r.RepeatFlowPattern(new r.ConditionFlowPattern(new r.ExpectUnitPattern("\\"),new r.AnyUnitPattern,new r.ConditionFlowPattern(new r.NotFlowPattern(new r.ExpectUnitPattern("'")),new r.AnyUnitPattern))),new r.ExpectUnitPattern("'")),h=new r.SetValuePattern(100,new r.ChooseFlowPattern(i,d),new r.OptFlowPattern(new r.RepeatFlowPattern(c)));t.Program=new r.ExpectFlowPattern(new r.OptFlowPattern(new r.RepeatFlowPattern(new r.ChooseFlowPattern(o,s,a,new r.EmitTokenPattern(r.TextSource.Output,new r.ChooseFlowPattern(m,f,p,h))))),new r.EndFlowPattern)},9134:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consumeNodes=void 0;const r=n(9171),o=(n(1323),n(2886)),s=n(4643),a=n(9994);t.consumeNodes=(e,t)=>{for(;void 0!==(e=e.next);)if(235===e.value)if(e instanceof r.Node){const n={directive:e};o.consume(t,n)}else t.addError(e,4099);else{const n=e.right;if(n instanceof r.Node){const r={directive:n};switch(e.value){case 236:s.consume(t,r);break;case 237:a.consume(t,r);break;case 238:s.consume(t,r);break;case 239:a.consume(t,r);break;default:t.addError(n,4099)}}else t.addError(e,4099)}return 0===t.errors.length}},1043:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(800);t.consume=(e,t)=>{if(t instanceof r.Node)return e.coder.emitExpectUnitsPattern([t.identity]);e.addError(t,4100)}},2341:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=t.resolve=void 0;const r=n(5072),o=n(8525),s=(n(1323),n(8827));t.resolve=(e,n,a)=>{if(212!==n.value){const t=s.consume(e,n,a);if(void 0!==t)return[t]}else{if(n instanceof r.Node){let t;return t=204===n.type?n.sequence.map((e=>o.extract(e.fragment.data))).join("").split(""):n.sequence.map((e=>e.identity)),[e.coder.emitExpectUnitsPattern(t)]}{const r=t.resolve(e,n.left,a);if(void 0!==r){const o=t.resolve(e,n.right,a);if(void 0!==o)return[...r,...o]}}}},t.consume=(e,n,r)=>{const o=t.resolve(e,n,r);if(void 0!==o)return o.length>1?e.coder.emitExpectPattern(...o):o[0]}},720:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(6443);t.consume=(e,t,n,o)=>{const s=r.resolve(e,t.right,n);if(void 0!==s){const t=n.directive.identity,[r,...a]=s;return e.coder.emitAppendPattern(t,o,r,...a)}}},4306:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(1323);const r=n(8827);t.consume=(e,t,n)=>{const o=r.consume(e,t.left,n);if(void 0!==o){const s=t.right;if(210===s.value){const t=r.consume(e,s.left,n);if(void 0!==t){const a=r.consume(e,s.right,n);if(void 0!==a)return e.coder.emitConditionPattern(o,t,a)}}else{const t=r.consume(e,s,n);if(void 0!==t)return e.coder.emitConditionPattern(o,t)}}}},9307:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=t.right,s=r.resolve(e,o.right,n);if(void 0!==s){const t=parseInt(o.fragment.data);return e.coder.emitErrorPattern(t,...s)}}},8827:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292),n(1323);const r=n(7133),o=n(6395),s=n(1129),a=n(8483),i=n(1043),u=n(4865),d=n(2341),c=n(4306),l=n(9293),m=n(6277),f=n(6987),p=n(8909),h=n(5902),g=n(720),P=n(4475),v=n(4260),w=n(4040),y=n(9307),b=n(6418),x=n(754);t.consume=(e,t,n)=>{switch(t.value){case 201:return r.consume(e,t,n);case 204:return o.consume(e,t,n);case 205:return e.coder.emitAnyPattern();case 206:return s.consume(e,t,n);case 207:return a.consume(e,t,n);case 234:return i.consume(e,t);case 209:return c.consume(e,t,n);case 211:return u.consume(e,t,n);case 212:return d.consume(e,t,n);case 213:return l.consume(e,t,n);case 214:return m.consume(e,t,n);case 215:return f.consume(e,t,n);case 219:case 218:return p.consume(e,t,n,1);case 216:return p.consume(e,t,n,2);case 217:return p.consume(e,t,n,0);case 223:case 222:return g.consume(e,t,n,1);case 220:return g.consume(e,t,n,2);case 221:return g.consume(e,t,n,0);case 227:case 226:return P.consume(e,t,n,1);case 224:return P.consume(e,t,n,2);case 225:return P.consume(e,t,n,0);case 228:return h.consume(e,t,n);case 229:return v.consume(e,t,n);case 230:return w.consume(e,t,n);case 231:return y.consume(e,t,n);case 232:return b.consume(e,t,n);case 233:return x.consume(e,t,n);default:e.addError(t,4099)}}},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=t.right,s=r.resolve(e,o.right,n);if(void 0!==s){const t=parseInt(o.fragment.data);return e.coder.emitHasPattern(t,...s)}}},8483:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(5072),o=n(800),s=n(7999),a=n(8525),i=(n(1323),n(8827)),u=e=>204===e.value?a.extract(e.fragment.data).split(""):e instanceof o.Node?[e.identity]:e instanceof r.Node?204!==e.type?e.sequence.map((e=>e.identity)):e.sequence.map((e=>a.extract(e.fragment.data))).join("").split(""):void 0;t.consume=(e,t,n)=>{let r=t.right;const o=n.directive,a=[];for(;void 0!==r;){const d=r.right;if(d instanceof s.Node){const r=u(d.route);if(void 0===r)e.addError(t,4099);else{let t;if(d.empty)t=0===o.type?e.coder.getRoute(r,void 0):e.coder.getRoute(r,d.identity);else{const s=i.consume(e,d,n);t=d.dynamic||0===o.type?e.coder.getRoute(r,void 0,s):e.coder.getRoute(r,d.identity,s)}a.push(t)}}else e.addError(t,4100);r=r.next}if(a.length>0)return e.coder.emitMapPattern(...a)}},9994:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(8827);t.consume=(e,t)=>{const n=t.directive,o=r.consume(e,n.right,t);if(void 0!==o){const t=e.nodeEntries.get(n.identifier);if(n.alias)t.pattern=o;else{const r=n.identity;if(t.pattern=e.coder.emitNodePattern(r,1,o),t.references>0){const n=`@LINK${t.identity}`;e.nodeEntries.add(t.origin,n,t.identity).pattern=e.coder.emitReferencePattern(e.nodeEntries,t.identifier),t.references++}}}}},9293:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o)return e.coder.emitNotPattern(...o)}},6277:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o)return e.coder.emitOptPattern(...o)}},4865:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=t.resolve=void 0;const r=n(5072),o=n(8525),s=(n(1323),n(8827));t.resolve=(e,n,a)=>{if(211!==n.value){const t=s.consume(e,n,a);if(void 0!==t)return[t]}else{if(n instanceof r.Node){if(204===n.type){const t=n.sequence.map((e=>o.extract(e.fragment.data)));if(t.length>3||void 0!==t.find((e=>e.length>1))){const n=t.map((t=>e.coder.getRoute(t.split(""))));return[e.coder.emitMapPattern(...n)]}return[e.coder.emitChooseUnitsPattern(t)]}{const t=n.sequence.map((e=>e.identity));if(t.length>3){const n=t.map((t=>e.coder.getRoute([t])));return[e.coder.emitMapPattern(...n)]}return[e.coder.emitChooseUnitsPattern(t)]}}{const r=t.resolve(e,n.left,a);if(void 0!==r){const o=t.resolve(e,n.right,a);if(void 0!==o)return[...r,...o]}}}},t.consume=(e,n,r)=>{const o=t.resolve(e,n,r);if(void 0!==o)return o.length>1?e.coder.emitChoosePattern(...o):o[0]}},5902:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(6443);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o){const t=n.directive.identity,[r,...s]=o;return e.coder.emitPivotPattern(t,r,...s)}}},8909:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n,o)=>{const s=r.resolve(e,t.right,n);if(void 0!==s)return e.coder.emitPlacePattern(o,...s)}},4475:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(6443);t.consume=(e,t,n,o)=>{const s=r.resolve(e,t.right,n);if(void 0!==s){const t=n.directive.identity,[r,...a]=s;return e.coder.emitPrependPattern(t,o,r,...a)}}},1129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(8525);t.consume=(e,t,n)=>{if(2!==n.directive.type){const n=r.extract(t.left.fragment.data),o=r.extract(t.right.fragment.data);return e.coder.emitRangePattern(n,o)}e.addError(t,4100)}},7133:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(800),o=(n(1323),(e,t,n)=>!n.pattern||n.references>1?e.emitReferencePattern(t,n.identifier):n.pattern);t.consume=(e,t,n)=>{const s=t.fragment.data,a=t.table.find(s);if(void 0!==a)switch(n.directive.type){case 0:return((e,t,n)=>{if(303===n.value){const n=t.fragment.data,r=e.tokenEntries.get(n);if(void 0!==r)return o(e.coder,e.tokenEntries,r);e.addError(t,4103)}})(e,t,a);case 1:return((e,t,n)=>{if(300===n.value||303===n.value){const n=t.fragment.data,r=e.tokenEntries.get(n);if(void 0!==r)return o(e.coder,e.tokenEntries,r);e.addError(t,4103)}})(e,t,a);case 2:return((e,t,n)=>{if(301===n.value||302===n.value){const n=t.fragment.data,r=e.nodeEntries.get(n);if(void 0!==r)return o(e.coder,e.nodeEntries,r);e.addError(t,4103)}if(t instanceof r.Node)return e.coder.emitExpectUnitsPattern([t.identity])})(e,t,a)}e.addError(t,4102)}},6987:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o)return e.coder.emitRepeatPattern(...o)}},4040:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o)return e.coder.emitScopePattern(...o)}},754:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(2341);t.consume=(e,t,n)=>{const o=t.right,s=r.resolve(e,o.right,n);if(void 0!==s){const t=parseInt(o.fragment.data);return e.coder.emitSetPattern(t,...s)}}},2886:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(8827);t.consume=(e,t)=>{const n=t.directive,o=r.consume(e,n.right,t);void 0!==o&&(e.skipEntries.get(n.identifier).pattern=o)}},6395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(8525);t.consume=(e,t,n)=>{if(2!==n.directive.type){const n=r.extract(t.fragment.data).split("");return e.coder.emitExpectUnitsPattern(n)}e.addError(t,4100)}},4260:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(6443);t.consume=(e,t,n)=>{const o=r.resolve(e,t.right,n);if(void 0!==o){const t=n.directive,[r,...s]=o;return e.coder.emitSymbolPattern(t.identity,r,...s)}}},4643:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(8827);t.consume=(e,t)=>{const n=t.directive,o=r.consume(e,n.right,t);if(void 0!==o){const t=e.tokenEntries.get(n.identifier);if(n.alias)t.pattern=o;else{const r=n.identity;if(t.pattern=e.coder.emitTokenPattern(r,o),t.references>0){const n=`@LINK${t.identity}`;e.tokenEntries.add(t.origin,n,t.identity).pattern=e.coder.emitReferencePattern(e.tokenEntries,t.identifier),t.references++}}}}},6443:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=void 0;const r=n(5072),o=n(8525),s=(n(1323),n(2341));t.resolve=(e,n,a)=>{if(212===n.value){if(!(n instanceof r.Node))return((e,n,r)=>{const o=t.resolve(e,n.left,r);if(void 0!==o){const s=t.resolve(e,n.right,r);if(void 0!==s)return[...o,...s]}})(e,n,a);if(n.sequence.length>1)return((e,t,n)=>{const r=t.sequence.shift(),a=s.resolve(e,t,n);if(void 0!==a){let n;return n=204===t.type?o.extract(r.fragment.data).split(""):[r.identity],[e.coder.emitExpectUnitsPattern(n),...a]}})(e,n,a)}return s.resolve(e,n,a)}},5602:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewState=void 0,t.getNewState=(e,t)=>({type:0,anchor:e,counter:t,entry:{origin:0,identifier:"?",identity:t,alias:!1,dynamic:!1}})},7013:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consumeNodes=void 0;const r=n(5292),o=(n(1323),n(5602)),s=n(1848),a=n(8204),i=n(1565),u=e=>{if(void 0!==e.left){const t=e.left.fragment.data;return"auto"===t?r.BaseSource.Output:parseInt(t)}};t.consumeNodes=(e,t)=>{let n,r=t.options.initialIdentity??0;for(;void 0!==(n=e.next);){const d=o.getNewState(e,r);if(235===n.value)d.counter++,s.consume(t,2,e,d);else switch(d.entry.identity=u(n.right)||d.counter++,n.value){case 236:a.consume(t,1,n,d);break;case 237:i.consume(t,1,n,d);break;case 238:d.entry.alias=!0,a.consume(t,1,n,d);break;case 239:d.entry.alias=!0,i.consume(t,1,n,d)}r=d.counter,e=d.anchor.next}return 0===t.errors.length}},4177:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=t.collision=void 0,n(5292);const r=n(8204),o=n(5602),s=n(6330);t.collision=(e,t,n)=>!!e.tokenEntries.has(n)&&(e.addError(t,4115),!0),t.resolve=(e,t,n,a)=>{const i=e.tokenEntries.get(a);return void 0!==i?(0===i.origin&&e.addError(t,4115),i):((e,t,n,a)=>{const i=o.getNewState(n.anchor,n.counter),u=s.getToken(`@REF${i.entry.identity}`,t.table,t.fragment.location,t);return i.entry.origin=1,i.counter++,r.consume(e,1,u,i),u.setChild(2,n.anchor.next),n.counter=i.counter,n.anchor.setChild(2,u),n.anchor=u,e.tokenEntries.get(a)})(e,t,n,a)}},6330:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getReference=t.getToken=t.getIdentifier=t.getIdentity=void 0;const r=n(5292);n(1323),t.getIdentity=(e,t,n)=>{const o=new r.Fragment(e,0,e.length,n);return new r.Node(o,202,t)},t.getIdentifier=(e,n,o)=>{const s=e.substr(4),a=new r.Fragment(e,0,e.length,o),i=new r.Node(a,200,n),u=new r.Record(a,300,i);return i.setChild(0,t.getIdentity(s,n,o)),n.add(u),i},t.getToken=(e,n,o,s)=>{const a=new r.Fragment("token",0,5,o),i=new r.Node(a,236,n),u=t.getIdentifier(e,n,o);return u.setChild(1,s),i.setChild(1,u),i},t.getReference=(e,t,n)=>{const o=new r.Fragment(e,0,e.length,n);return new r.Node(o,201,t)}},6016:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(800),o=e=>void 0!==e.left&&void 0!==e.right?[...o(e.left),...o(e.right)]:void 0!==e.left?o(e.left):void 0!==e.right?o(e.right):[e.fragment.data];t.consume=(e,t,n,s)=>{const a=n.getChild(t),i=o(a),u=i.join("@");if(3!==s.type||e.nodeEntries.has(u))e.addError(a,4113);else{const o=e.tokenEntries.get(i[0]),s=e.tokenEntries.get(u);o&&s?s.dynamic?e.addError(a,4112):o.alias?e.addError(a,4113):n.setChild(t,new r.Node(a,s.identity)):e.addError(a,4102)}}},5166:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292),n(1323);const r=n(8110),o=n(1200),s=n(1057),a=n(7725),i=n(2539),u=n(6016);t.consume=(e,n,d,c)=>{const l=d.getChild(n);switch(l.value){case 205:case 206:a.consume(e,n,d,c);break;case 201:r.consume(e,n,d,c);break;case 204:s.consume(e,n,d,c);break;case 207:i.consume(e,n,d,c);break;case 234:u.consume(e,n,d,c);break;case 211:o.consume(e,n,d,211,c);break;case 212:o.consume(e,n,d,212,c);break;default:t.consume(e,1,l,c)}}},2539:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(7999),o=n(5072),s=n(800),a=(n(1323),n(4177)),i=n(5166),u=(e,t)=>{if(209!==e.value&&211!==e.value){if(204===e.value||e instanceof s.Node||e instanceof o.Node){if(void 0!==t){const e=t.right;t.setChild(0,void 0),t.setChild(1,void 0),t.swap(e)}return e}if(void 0!==e.left)return u(e.left,e)}};t.consume=(e,t,n,o)=>{let s=n.getChild(t).right;for(o.entry.dynamic=!0;void 0!==s;){const t=s.right;if(200===t.value){if(1===o.type){e.addError(t,4101);break}const n=o.entry;o.entry={origin:0,identity:void 0!==t.left?parseInt(t.left.fragment.data):o.entry.identity,identifier:`${o.entry.identifier}@${t.fragment.data}`,alias:!1,dynamic:!1},i.consume(e,1,t,o);const d=u(t.right);if(void 0!==d){204===d.value&&a.collision(e,d,d.fragment.data);const{origin:n,identifier:i,identity:u}=o.entry,c=new r.Node(t.right,o.entry,d);2===o.type?e.tokenEntries.add(n,i,u,o.entry):e.nodeEntries.add(n,i,u,o.entry),s.setChild(1,c)}else e.addError(s,4114);o.entry=n}else{i.consume(e,1,s,o);const t=u(s.right);void 0!==t?(204===t.value&&a.collision(e,t,t.fragment.data),s.setChild(1,new r.Node(s.right,{...o.entry},t))):e.addError(s,4114)}s=s.next}}},1200:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(800),o=n(5072),s=(n(1323),n(5166)),a=(e,t)=>e.value===t?!(e instanceof o.Node)&&a(e.left,t)&&a(e.right,t):204===e.value,i=(e,t)=>e.value===t?!(e instanceof o.Node)&&i(e.left,t)&&i(e.right,t):e instanceof r.Node;t.consume=(e,t,n,r,u)=>{const d=n.getChild(t);d.value!==r?s.consume(e,t,n,u):3===u.type?(s.consume(e,0,d,u),s.consume(e,1,d,u),i(d,r)&&n.setChild(t,new o.Node(d,201))):a(d,r)?n.setChild(t,new o.Node(d,204)):(s.consume(e,0,d,u),s.consume(e,1,d,u))}},1565:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(9171),o=n(5166);t.consume=(e,t,n,s)=>{const a=n.getChild(t),i=s.type;s.type=3,s.entry.identifier=a.fragment.data,o.consume(e,1,a,s),((e,t,n,o)=>{const{origin:s,identifier:a,identity:i}=o.entry,u=n.getChild(t),d=e.nodeEntries.add(s,a,i,o.entry),c=new r.Node(u,2,d);n.setChild(t,c)})(e,t,n,s),s.type=i}},7725:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(4177),o=n(6330),s=n(5166);t.consume=(e,t,n,a)=>{if(3===a.type){const i=n.getChild(t),u=`${i.left.fragment.data}-${i.right.fragment.data}`,d=r.resolve(e,i,a,u),c=o.getReference(d.identifier,i.table,i.fragment.location);n.setChild(t,c),s.consume(e,t,n,a)}}},8110:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(800);n(1323),t.consume=(e,t,n,o)=>{const s=n.getChild(t),a=s.fragment.data,i=s.table.find(a);if(void 0===i)e.addError(s,4102);else switch(o.type){case 1:((e,t,n)=>{if(303!==n.value)300===n.value?e.addError(t,4108):301===n.value?e.addError(t,4109):302===n.value?e.addError(t,4111):e.addError(t,4103);else{const n=t.fragment.data,r=e.tokenEntries.get(n);void 0!==r?r.references++:e.tokenEntries.on(n,(e=>{e.references++,e.force=!0}))}})(e,s,i);break;case 2:((e,t,n)=>{if(300!==n.value&&303!==n.value)301===n.value?e.addError(t,4109):302===n.value?e.addError(t,4111):e.addError(t,4103);else{const n=t.fragment.data,r=e.tokenEntries.get(n);void 0!==r?r.references++:e.tokenEntries.on(n,(e=>{e.references++,e.force=!0}))}})(e,s,i);break;case 3:((e,t,n,o)=>{const s=n.getChild(t),a=s.fragment.data;if(301===o.value||302===o.value){const t=e.nodeEntries.get(a);void 0!==t?t.references++:e.nodeEntries.on(a,(e=>{e.references++,e.force=!0}))}else if(300===o.value){const o=e.tokenEntries.get(a);void 0!==o?(o.references++,o.dynamic?e.addError(s,4112):n.setChild(t,new r.Node(s,o.identity))):e.tokenEntries.on(a,(o=>{o.references++,o.force=!0,o.dynamic?e.addError(s,4112):n.setChild(t,new r.Node(s,o.identity))}))}else 303===o.value?e.addError(s,4110):e.addError(s,4103)})(e,t,n,i)}}},1848:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(9171),o=n(5166);t.consume=(e,t,n,s)=>{const a=n.getChild(t),i=s.type;s.type=1,s.entry.identifier=`@SKIP${s.entry.identity}`,o.consume(e,1,a,s),((e,t,n,o)=>{const s=n.getChild(t),a=e.skipEntries.add(o.entry.origin,o.entry.identifier,o.entry.identity,o.entry),i=new r.Node(s,0,a);n.setChild(t,i)})(e,t,n,s),s.type=i}},1057:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0;const r=n(4177),o=n(6330),s=n(5166);t.consume=(e,t,n,a)=>{if(3===a.type){const i=n.getChild(t),u=i.fragment.data,d=r.resolve(e,i,a,u),c=o.getReference(d.identifier,i.table,i.fragment.location);n.setChild(t,c),s.consume(e,t,n,a)}}},8204:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=void 0,n(5292);const r=n(9171),o=(n(1323),n(4177)),s=n(5166),a=n(7725),i=n(1057),u=(e,t,n,o)=>{const{origin:s,identifier:a,identity:i}=o.entry,u=n.getChild(t),d=e.tokenEntries.add(s,a,i,o.entry),c=new r.Node(u,1,d);n.setChild(t,c)};t.consume=(e,t,n,r)=>{const d=n.getChild(t),c=d.right,l=r.entry,m=r.type;if(r.type=2,l.identifier=d.fragment.data,204===c.value){i.consume(e,1,d,r);const s=c.fragment.data;o.collision(e,c,s)||(u(e,t,n,r),e.tokenEntries.link(s,r.entry.identifier))}else if(206===c.value){a.consume(e,1,d,r);const s=`${c.left.fragment.data}-${c.right.fragment.data}`;o.collision(e,c,s)||(u(e,t,n,r),e.tokenEntries.link(s,r.entry.identifier))}else s.consume(e,1,d,r),u(e,t,n,r);r.type=m}},1323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consume=t.consumeTokens=void 0;const r=n(5292),o=n(6633);t.consumeTokens=(e,t)=>{const n=new r.TokenSource(e,t);if(!o.Program.consume(n)){const r=e[n.longestState.offset]?.fragment??n.fragment;return t.addError(r,4098),!1}return!0},t.consume=e=>o.Program.consume(e)},5689:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5292);class o extends r.Pattern{#pattern;constructor(e,t){super(),this.#pattern=new r.ExpectFlowPattern(t,new r.OptFlowPattern(new r.RepeatFlowPattern(new r.PivotNodePattern(r.BaseSource.Output,1,0,e,t))))}consume(e){return this.#pattern.consume(e)}}t.default=o},6825:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5292);n(4465);class o extends r.Pattern{#pattern;constructor(e,t,n){super(),this.#pattern=new r.ExpectFlowPattern(new r.OptFlowPattern(t),new r.EmitSymbolPattern(e,new r.PivotNodePattern(200,1,0,new r.ExpectUnitPattern(100)),new r.ExpectUnitPattern(131),new r.PlaceNodePattern(1,n)))}consume(e){return this.#pattern.consume(e)}}t.default=o},6815:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5292);class o extends r.Pattern{#pattern;constructor(e,t){super(),this.#pattern=new r.ExpectFlowPattern(new r.OptFlowPattern(new r.RepeatFlowPattern(new r.AppendNodePattern(r.BaseSource.Output,1,1,e))),t)}consume(e){return this.#pattern.consume(e)}}t.default=o},6633:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const r=n(5292),o=(n(4465),n(6825)),s=n(5689),a=n(6815),i=new r.ExpectFlowPattern(new r.ExpectUnitPattern(142),new r.AppendNodePattern(202,0,1,new r.ChooseUnitPattern(101,130),new r.ExpectUnitPattern(143))),u=new r.ExpectFlowPattern(new r.ExpectUnitPattern(142),new r.AppendNodePattern(203,0,1,new r.ExpectUnitPattern(101),new r.ExpectUnitPattern(143))),d=new r.MapFlowPattern(new r.SetValueRoute(213,111),new r.SetValueRoute(214,112),new r.SetValueRoute(215,113),new r.SetValueRoute(216,114,118),new r.SetValueRoute(217,114,119),new r.SetValueRoute(218,114,120),new r.SetValueRoute(219,114),new r.SetValueRoute(220,115,118),new r.SetValueRoute(221,115,119),new r.SetValueRoute(222,115,120),new r.SetValueRoute(223,115),new r.SetValueRoute(224,116,118),new r.SetValueRoute(225,116,119),new r.SetValueRoute(226,116,120),new r.SetValueRoute(227,116),new r.SetValueRoute(228,117),new r.SetValueRoute(229,121),new r.SetValueRoute(230,122),new r.SetValueRoute(231,u,123),new r.SetValueRoute(232,u,124),new r.SetValueRoute(233,u,125)),c=new r.ExpectFlowPattern(new r.AppendNodePattern(208,1,2,new r.ChooseFlowPattern(new o.default(304,i,new r.RunFlowPattern((()=>g))),new r.RunFlowPattern((()=>g)))),new r.OptFlowPattern(new r.ExpectUnitPattern(136),new r.RunFlowPattern((()=>c)))),l=new r.ScopeSymbolPattern(new r.ExpectUnitPattern(106),new r.AppendNodePattern(207,1,1,new r.ExpectFlowPattern(new r.ExpectUnitPattern(138),new r.OptFlowPattern(c),new r.ExpectUnitPattern(139)))),m=new r.PlaceNodePattern(1,new r.ExpectUnitPattern(104),new r.AppendNodePattern(204,1,1,new r.ExpectUnitPattern(102)),new r.PivotNodePattern(206,1,0,new r.ExpectUnitPattern(105),new r.AppendNodePattern(204,1,1,new r.ExpectUnitPattern(102)))),f=new r.AppendNodePattern(r.BaseSource.Output,1,1,new r.MapFlowPattern(new r.SetValueRoute(205,103),new r.SetValueRoute(205,132),new r.SetValueRoute(204,102),new r.SetValueRoute(201,100))),p=new r.PlaceNodePattern(1,new r.ExpectFlowPattern(new r.ExpectUnitPattern(140),new r.RunFlowPattern((()=>g)),new r.ExpectUnitPattern(141))),h=new r.OptFlowPattern(new r.PivotNodePattern(209,1,0,new r.ExpectUnitPattern(107),new r.RunFlowPattern((()=>g)),new r.OptFlowPattern(new r.PivotNodePattern(210,1,0,new r.ExpectUnitPattern(108),new r.RunFlowPattern((()=>g)))))),g=new r.ExpectFlowPattern(new s.default(new r.SetValuePattern(211,new r.ChooseUnitPattern(109,133)),new s.default(new r.SetValuePattern(212,new r.ChooseUnitPattern(110,134)),new a.default(d,new r.PlaceNodePattern(1,new s.default(new r.SetValuePattern(234,new r.ExpectUnitPattern(135)),new r.ChooseFlowPattern(l,m,f,p)))))),h),P=new r.SetValueRoute(235,g,126),v=new r.SetValueRoute(236,new o.default(300,i,g),127),w=new r.SetValueRoute(237,new o.default(301,i,g),128),y=new r.SetValueRoute(238,new o.default(303,i,g),129,127),b=new r.SetValueRoute(239,new o.default(302,i,g),129,128);t.Program=new r.ExpectFlowPattern(new r.OptFlowPattern(new r.RepeatFlowPattern(new r.ChooseFlowPattern(new r.EmitNodePattern(r.BaseSource.Output,1,new r.MapFlowPattern(P,v,w,y,b),new r.ExpectUnitPattern(137))))),new r.EndFlowPattern)},7549:e=>{e.exports=require("vscode")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=n(7549),o=n(2550),s=n(9454);e.activate=function(e){const n=t.languages.createDiagnosticCollection("xcheme");e.subscriptions.push(t.languages.registerCompletionItemProvider("xcheme",new s.Provider,".")),e.subscriptions.push((e=>t.workspace.onDidChangeTextDocument((t=>{o.update(t.document,e)})))(n),(e=>t.window.onDidChangeActiveTextEditor((t=>{t&&o.update(t.document,e)})))(n)),t.window.activeTextEditor&&o.update(t.window.activeTextEditor.document,n)},e.deactivate=function(){}})(),module.exports=r})();